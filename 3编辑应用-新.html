<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<meta content="yes" name="apple-mobile-web-app-capable" /> 
		<meta content="black" name="apple-mobile-web-app-status-bar-style" /> 
		<meta content="telephone=no" name="format-detection" /> 
		<title>3编辑应用-新</title>
		<link href="css/base.css" rel="stylesheet" type="text/css" />
		<link href="css/style.css" rel="stylesheet" type="text/css" />
		<script src="js/ratio.js" type="text/javascript"></script>
		<style type="text/css">
			.znavIcons-list { padding-top: 0;}
			.znavIcons-list {
  -webkit-tap-highlight-color: transparent;
  -webkit-touch-callout: none;
  -webkit-user-select: none;
}
			
			.znavIcons-add p { width: 10px; height: 10px; background: #007AFF; border-radius: 50%;}
			.znavIcons-add p:after { display: block; content: ''; height: 10px; background: #007AFF;}
			.znavIcons-ani { transition: all .2s ease-in-out;}
		</style>
	</head>

	<body>
		<!--main start-->
		<div class="zmain">
		
			<div class="znavIcons">
				<h1 class="cx_ht-md cx_bggray">你可以将常用的应用添加到首页，长按拖动调整应用顺序</h1>
				<div class="znavIcons-list" style="padding-top: .3rem;" id="znavIcons-list">
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="111">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_03.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)" >我的课程</a></li>
						<li class="znavIcons-delete handler-js" list-type="jiaoxue"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="112">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_05.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">知识检索</a></li>
						<li class="znavIcons-delete handler-js" list-type="jiaoxue"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="153">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_07.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">推荐案例</a></li>
						<li class="znavIcons-delete handler-js" list-type="bangong"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="144">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_09.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">推荐资源</a></li>
						<li class="znavIcons-delete handler-js" list-type="jiaoxue"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="115">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_18.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">时事热点</a></li>
						<li class="znavIcons-delete handler-js" list-type="bangong"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="118">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_16.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">学生自测</a></li>
						<li class="znavIcons-delete handler-js" list-type="bangong"></li>
					</ul>
					
					
				</div>
			</div>
			<div class="znavIcons">
				<header class="cx_ht-lg">
					<h2>教学辅助</h2>
				</header>
				<div class="znavIcons-list" id="list_jiaoxue">
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="114">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_20.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">思政资源库</a></li>
						<li class="znavIcons-add handler-js" list-type="jiaoxue"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="134">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_25.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">网络资源库</a></li>
						<li class="znavIcons-add handler-js" list-type="jiaoxue"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="164">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_31.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">实践活动</a></li>
						<li class="znavIcons-add handler-js" list-type="jiaoxue"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="131">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_33.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">思政学银</a></li>
						<li class="znavIcons-add handler-js" list-type="jiaoxue"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="136">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_35.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)" >思政直播</a></li>
						<li class="znavIcons-add handler-js" list-type="jiaoxue"></li>
					</ul>
				</div>
			</div>
			<div class="znavIcons">
				<header class="cx_ht-lg">
					<h2>办公辅助</h2>
				</header>
				<div class="znavIcons-list" id="list_bangong">
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="221">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_44.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">通知</a></li>
						<li class="znavIcons-add handler-js" list-type="bangong"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="234">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_39.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">发签到</a></li>
						<li class="znavIcons-add handler-js" list-type="bangong"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="229">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_40.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">发投票</a></li>
						<li class="znavIcons-add handler-js" list-type="bangong"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="228">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_41.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">投屏</a></li>
						<li class="znavIcons-add handler-js" list-type="bangong"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="261">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_50.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">表单</a></li>
						<li class="znavIcons-add handler-js" list-type="bangong"></li>
					</ul>
					<ul class="znavIcons-item znavIcons-ani znavIcons-relative dragSort-js" sid="266">
						<li class="znavIcons-img"><a style="background-image: url(images/icons_49.png);" href="javascript:void(0)"></a></li>
						<li class="znavIcons-name"><a href="javascript:void(0)">视频会议</a></li>
						<li class="znavIcons-add handler-js" list-type="bangong"></li>
					</ul>
				</div>
			</div>
		</div>
		<!--main end-->
		<script src="js/dragSort.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
			var box1 = document.getElementById('znavIcons-list')
			var dragbox1 = new DragSort(box1, function (o) {
				// 返回排序 数组
				console.log(o)
			})
			//动态更新元素时使用： dragbox1.upDate()
			// dragbox1.upDate()
			// 消毁该拖放元素时使用 dragbox1.destroy() dragbox1 = null
		</script>
		<script type="text/javascript">
			/**
			 * 
			 * @param {Object} options 配置项
			 */
			function BToA (options) {
				var _this = this	
				this.options = {
					iconCLS1: 'znavIcons-add', // 按钮1
					iconCLS2: 'znavIcons-delete',  // 按钮2
					doFn: null, // 操作开始时触发回调函数
					successFn: null // 操作结束时触发回调函数
				}
				if (options) {
					for (f in options) {
						this.options[f] = options[f]
					}
				}
				var bodyDom = document.getElementsByTagName('body')[0]
				var siteDom = document.createElement('div')
				this.isClick = true // 防止连击操作
				
				var clearTimer = null
				
				function toList(toDom, curDom, fromDom) {
					if (_this.options.doFn) _this.options.doFn({from:fromDom, to:toDom, cur: curDom}) // 触发开始添加函数
					var cloneSiteDom = siteDom.cloneNode(true)
						cloneSiteDom.style.float = 'left'
						cloneSiteDom.className = 'znavIcons-item site-js'
						toDom.appendChild(cloneSiteDom)
						
						var virdom = curDom.cloneNode(true)
						virdom.style.cssText = 'position:absolute;left:' + curDom.offsetLeft + 'px;top:' + curDom.offsetTop + 'px;' + 'opacity: 1'
						bodyDom.appendChild(virdom)
						virdom.style.cssText = 'position:absolute;left:' + cloneSiteDom.offsetLeft + 'px;top:' + cloneSiteDom.offsetTop + 'px;' + 'opacity: 1'
						if (clearTimer) clearTimeout(clearTimer)
						clearTimer = setTimeout(function () {
							var currentDom = curDom.querySelector('.handler-js')
							toDom.appendChild(curDom)
							cloneSiteDom.remove()
							virdom.remove()
							if (_this.options.successFn) _this.options.successFn({from:fromDom, to:toDom, cur: curDom}) // 触发添加成功函数
							iconsToggle(currentDom, _this.options.iconCLS1)
							currentDom.addEventListener('touchstart', function (e) {
								e.stopPropagation()
								if (!_this.isClick) return
								_this.isClick = false
								this.removeEventListener('touchstart', arguments.callee)
								var newThis = this.parentElement
								toList(fromDom, newThis, toDom)
							}, false)
							_this.isClick = true
							if (clearTimer) clearTimeout(clearTimer)
						}, 450)
				}
				
				/**
				 * 添加图标和删除图标相互切换
				 * @param {Object} el dom对象
				 * @param {Object} c class样式名称
				 */
				function iconsToggle (el, cls) {
					var re = new RegExp("(^|\\s)" + cls + "(\\s|$)")
			        var isHas = re.test(el.className)
			        if (isHas) {
			        	el.classList.remove(_this.options.iconCLS1)
						el.classList.add(_this.options.iconCLS2)
			        } else {
			        	el.classList.remove(_this.options.iconCLS2)
						el.classList.add(_this.options.iconCLS1)
			        }
			        return re.test(el.className);
				}
				
				/**
				 * from 向 to  添加
				 * @param {Object} from dom对象
				 * @param {Object} to dom对象
				 */
				this.from_to = function (from, to) {
					var aItems = from.querySelectorAll('.handler-js')
					for (var q = 0; q < aItems.length; q++) {
						aItems[q].addEventListener('touchstart', function (e) {
							e.stopPropagation()
							if (!_this.isClick) return
							_this.isClick = false
							this.removeEventListener('touchstart', arguments.callee)
							var newThis = this.parentElement
							toList(to, newThis, from)
						}, false)
					}
				}
			
				/**
				 * from 对  多 按list-type类添加
				 * @param {Object} from dom对象
				 */
				this.to_fromBC = function (from) {
					var aItems = from.querySelectorAll('.handler-js')
					for (var q = 0; q < aItems.length; q++) {
						aItems[q].addEventListener('touchstart', function (e) {
							e.stopPropagation()
							if (!_this.isClick) return
							_this.isClick = false
							this.removeEventListener('touchstart', arguments.callee)
							var listId = 'list_' + this.getAttribute('list-type')
							var newList = document.getElementById(listId)
							var newThis = this.parentElement
							toList(newList, newThis, from)
						}, false)
					}
				}
			
			}	
				
			/**
			 * 添加图标和删除图标相互切换
			 * @param {Object} el dom对象
			 * @param {Object} cls class样式名称
			 */
/*此注释不可删除
 * 此注释不可删除
 * 此注释不可删除
 * 此注释不可删除
 * 			function iconsToggle (el, cls) {
				var re = new RegExp("(^|\\s)" + cls + "(\\s|$)")
		        var isHas = re.test(el.className)
		        if (isHas) {
		        	el.classList.remove('znavIcons-add')
					el.classList.add('znavIcons-delete')
		        } else {
		        	el.classList.remove('znavIcons-delete')
					el.classList.add('znavIcons-add')
		        }
		        return re.test(el.className);
			}*/
				
			// 实例化	
			var znavIconsList = document.getElementById('znavIcons-list')
			var bangong = document.getElementById('list_bangong')
			var jiaoxue = document.getElementById('list_jiaoxue')
			var moveIcons = new BToA({
				doFn: function (o) { // 操作开始时触发
					console.log(o)
				},
				successFn: function (o) { // 操作结束时触发
					console.log(o)
					dragbox1.upDate()
					// iconsToggle(currentDom, 'znavIcons-add')
				}
			})
			moveIcons.from_to(bangong, znavIconsList)
			moveIcons.from_to(jiaoxue, znavIconsList)
			moveIcons.to_fromBC(znavIconsList)
		</script>
	</body>
</html>
